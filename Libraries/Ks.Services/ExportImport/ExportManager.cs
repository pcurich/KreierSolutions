using System;
using System.Collections.Generic;
using System.Drawing;
using System.Globalization;
using System.Text;
using Ks.Core.Domain.Directory;
using System.IO;
using System.Linq;
using Ks.Core;
using Ks.Core.Domain;
using Ks.Core.Domain.Batchs;
using Ks.Core.Domain.Contract;
using Ks.Core.Domain.Customers;
using Ks.Core.Domain.Reports;
using Ks.Services.Customers;
using Ks.Services.Helpers;
using Ks.Services.KsSystems;
using OfficeOpenXml;
using OfficeOpenXml.Style;

namespace Ks.Services.ExportImport
{
    /// <summary>
    /// Export manager
    /// </summary>
    public partial class ExportManager : IExportManager
    {
        #region Fields

        private readonly IKsSystemService _ksSystemService;
        private readonly KsSystemInformationSettings _ksSystemInformationSettings;
        private readonly IWebHelper _webHelper;
        private readonly IDateTimeHelper _dateTimeHelper;
        private readonly ICustomerAttributeService _customerAttributeService;

        private readonly SignatureSettings _signatureSettings;

        #endregion

        #region Ctor

        public ExportManager(IKsSystemService ksSystemService,
            KsSystemInformationSettings ksSystemInformationSettings,
            ICustomerAttributeService customerAttributeService,
            IWebHelper webHelper, IDateTimeHelper dateTimeHelper, SignatureSettings signatureSettings)
        {
            _ksSystemService = ksSystemService;
            _ksSystemInformationSettings = ksSystemInformationSettings;
            _webHelper = webHelper;
            _dateTimeHelper = dateTimeHelper;
            _customerAttributeService = customerAttributeService;
            _signatureSettings = signatureSettings;
        }

        #endregion

        private const String IMAGE =
            "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";

        private const String ESCUDO =
            "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";

        #region Methods

        /// <summary>
        /// Export states to TXT
        /// </summary>
        /// <param name="states">States</param>
        /// <returns>Result in TXT (string) format</returns>
        public virtual string ExportStatesToTxt(IList<StateProvince> states)
        {
            if (states == null)
                throw new ArgumentNullException("states");

            const string SEPARATOR = ",";
            var sb = new StringBuilder();
            foreach (var state in states)
            {
                sb.Append(state.Country.TwoLetterIsoCode);
                sb.Append(SEPARATOR);
                sb.Append(state.Name);
                sb.Append(SEPARATOR);
                sb.Append(state.Abbreviation);
                sb.Append(SEPARATOR);
                sb.Append(state.Published);
                sb.Append(SEPARATOR);
                sb.Append(state.DisplayOrder);
                sb.Append(Environment.NewLine);  //new line
            }
            return sb.ToString();
        }

        public virtual void ExportReportContributionPaymentToXlsx(Stream stream, Customer customer, Contribution contribution, IList<ReportContributionPayment> reportContributionPayment)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Aportaciones");
                try
                {
                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e) { }

                #region Summary
                worksheet.Cells["A6:B8"].Style.Font.Bold = true;
                worksheet.Cells["G6:H8"].Style.Font.Bold = true;

                worksheet.Cells["A6:B6"].Merge = true;
                worksheet.Cells["A6"].Value = "Aportante:";
                worksheet.Cells["C6:E6"].Merge = true;
                worksheet.Cells["C6"].Value = customer.GetFullName();
                worksheet.Cells["A7:B7"].Merge = true;
                worksheet.Cells["A7"].Value = "Dni:";
                worksheet.Cells["C7"].Value = customer.GetGenericAttribute(SystemCustomerAttributeNames.Dni);
                worksheet.Cells["A8:B8"].Merge = true;
                worksheet.Cells["A8"].Value = "N° Adm:";
                worksheet.Cells["C8"].Value = customer.GetGenericAttribute(SystemCustomerAttributeNames.AdmCode);

                worksheet.Cells["G6:H6"].Merge = true;
                worksheet.Cells["G6"].Value = "Monto:";
                worksheet.Cells["I6"].Value = contribution.AmountPayed.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells["G7:H7"].Merge = true;
                worksheet.Cells["G7"].Value = "Aportante desde:";
                worksheet.Cells["I7"].Value = _dateTimeHelper.ConvertToUserTime(contribution.CreatedOnUtc, TimeZoneInfo.Utc).ToShortDateString();

                worksheet.Cells["G8:H8"].Merge = true;
                worksheet.Cells["G8"].Value = "Ultimo Pago:";
                if (contribution.UpdatedOnUtc.HasValue)
                    worksheet.Cells["I8"].Value = _dateTimeHelper.ConvertToUserTime(contribution.UpdatedOnUtc.Value, TimeZoneInfo.Utc).ToShortDateString();
                #endregion

                #region Leyend

                worksheet.Cells["M3:M8"].Style.Font.Bold = true;
                worksheet.Cells["L3"].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["L3"].Style.Fill.BackgroundColor.SetColor(GetColor(1, ((int)ContributionState.Pendiente)));
                worksheet.Cells["M3:N3"].Merge = true;
                worksheet.Cells["M3"].Value = ContributionState.Pendiente.ToString();
                worksheet.Cells["L4"].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["L4"].Style.Fill.BackgroundColor.SetColor(GetColor(1, ((int)ContributionState.EnProceso)));
                worksheet.Cells["M4:N4"].Merge = true;
                worksheet.Cells["M4"].Value = ContributionState.EnProceso.ToString();
                worksheet.Cells["L5"].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["L5"].Style.Fill.BackgroundColor.SetColor(GetColor(1, ((int)ContributionState.PagoParcial)));
                worksheet.Cells["M5:N5"].Merge = true;
                worksheet.Cells["M5"].Value = ContributionState.PagoParcial.ToString();
                worksheet.Cells["L6"].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["L6"].Style.Fill.BackgroundColor.SetColor(GetColor(1, ((int)ContributionState.Pagado)));
                worksheet.Cells["M6:N6"].Merge = true;
                worksheet.Cells["M6"].Value = ContributionState.Pagado.ToString() + " Automático";
                worksheet.Cells["L7"].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["L7"].Style.Fill.BackgroundColor.SetColor(GetColor(0, ((int)ContributionState.Pagado)));
                worksheet.Cells["M7:N7"].Merge = true;
                worksheet.Cells["M7"].Value = ContributionState.Pagado.ToString() + " Manual";
                worksheet.Cells["L8"].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["L8"].Style.Fill.BackgroundColor.SetColor(GetColor(0, ((int)ContributionState.SinLiquidez)));
                worksheet.Cells["M8:N8"].Merge = true;
                worksheet.Cells["M8"].Value = ContributionState.SinLiquidez.ToString();
                #endregion

                //Create Headers and format them 
                var properties = new[]
                    {
                        "AÑO",
                        "ENERO","FEBRERO","MARZO","ABRIL","MAYO",
                        "JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE",
                        "NOVIEMBRE","DICIEMBRE", "TOTAL"
                    };
                for (int i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[10, i + 1].Value = properties[i];
                    worksheet.Cells[10, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[10, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[10, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[10, i + 1].Style.Font.Bold = true;
                }

                int row = 11;
                decimal ene, feb, mar, abr, may, jun, jul, ago, sep, oct, nov, dic, total;
                int t;
                foreach (var p in reportContributionPayment)
                {
                    int col = 1;
                    if (worksheet.Cells[row - 1, col].Value != null && int.TryParse(worksheet.Cells[row - 1, col].Value.ToString(), out t)
                        && Convert.ToInt32(worksheet.Cells[row - 1, col].Value.ToString()) == p.Year)
                        row--;

                    worksheet.Cells[row, col].Value = p.Year;
                    col++;

                    ene = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Ene);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = ene;
                    col++;

                    feb = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Feb);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = feb;
                    col++;

                    mar = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Mar);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = mar;
                    col++;

                    abr = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Abr);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = abr;
                    col++;

                    may = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.May);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = may;
                    col++;

                    jun = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Jun);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = jun;
                    col++;

                    jul = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Jul);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = jul;
                    col++;

                    ago = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Ago);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = ago;
                    col++;

                    sep = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Sep);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = sep;
                    col++;

                    oct = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Oct);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = oct;
                    col++;

                    nov = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Nov);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = nov;
                    col++;

                    dic = Convert.ToDecimal(worksheet.Cells[row, col].Value) + (p.Dic);
                    if (worksheet.Cells[row, col].Value == null)
                    {
                        worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                        worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                    }
                    else
                    {
                        if (Convert.ToDecimal(worksheet.Cells[row, col].Value) == 0)
                        {
                            worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                            worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(GetColor(p.IsAutomatic, p.StateId));
                        }
                    }
                    worksheet.Cells[row, col].Value = dic;
                    col++;

                    total = ene + feb + mar + abr + may + jun + jul + ago + sep + oct + nov + dic;
                    worksheet.Cells[row, col].Value = total;
                    worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(Color.White);
                    col++;

                    row++;
                }

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }

                xlPackage.Save();
            }
        }

        public virtual string ExportReportContributionPaymentToPdf(Customer customer, Contribution contribution, IList<ReportContributionPayment> reportContributionPayment)
        {
            const String IMAGE =
                "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";

            var sb = new StringBuilder();

            var img = "</br>";

            img += "<img style='display:block; width:250px;height:80px;' id='base64image'" +
                   "src='data:image/jpeg;base64, " + IMAGE + "' />" +
                   "</br>" +
                   "<table style='font-family:arial; font-size:10px;'>" +
                   "<tr>" +
                   "<td align='center'  rowspan='4' style='width:30%;'>AUXILIO COOPERATIVO MILITAR DE RETIROS</td>" +
                   "</tr>" +
                   "<tr>" +
                   "<td align='center'  style='width:30%;'>  Jirón Cervantes N°197 </td>" +
                   "</tr>" +
                   "<tr>" +
                   "<td align='center'  rowspan='4' style='width:30%;'>Cercado de Lima</td>" +
                   "</tr>" +
                   "</table>" +
                   "</br>";

            sb.Append(img);


            //Generando las cabeceras
            //tabla de resumen
            sb.Append("<table><tr>" +
                      "<td align='left' style='width:100%;'>");

            sb.Append("<table style='font-family:arial; font-size:10px;'>" +
                      "<tr>" +
                          "<td rowspan='4' style='width:30%;'><b>Aportante:</b></td>" +
                          "<td style='width:40%;'> " + customer.GetFullName() + " </td>" +
                          "<td rowspan='4' style='width:30%;'><b>Monto:</b></td>" +
                          "<td style='width:40%;'> " + contribution.AmountPayed.ToString("c", new CultureInfo("es-PE")) + " </td>" +
                      "</tr>" +
                      "</table>" +

                      "<table style='font-family:arial; font-size:10px;'>" +
                      "<tr>" +
                      "<td rowspan='4' style='width:30%;'><b>Dni:</b></td>" +
                      "<td style='width:40%;'> " + customer.GetGenericAttribute(SystemCustomerAttributeNames.Dni) +
                      " </td>" +
                      "<td rowspan='4' style='width:30%;'><b>Aporte desde:</b></td>" +
                      "<td style='width:40%;'> " + _dateTimeHelper.ConvertToUserTime(contribution.CreatedOnUtc, TimeZoneInfo.Utc).ToShortDateString() + " </td>" +
                      "</tr>" +
                      "</table>" +

                      "<table style='font-family:arial; font-size:10px;'>" +
                      "<tr>" +
                      "<td rowspan='4' style='width:30%;'><b>N° Adm:</b></td>" +
                      "<td style='width:40%;'> " + customer.GetGenericAttribute(SystemCustomerAttributeNames.AdmCode) +
                      " </td>" +
                      "<td rowspan='4' style='width:30%;'><b>Último Pago:</b></td>" +
                      "<td style='width:40%;'> " + (contribution.UpdatedOnUtc.HasValue ? _dateTimeHelper.ConvertToUserTime(contribution.UpdatedOnUtc.Value, TimeZoneInfo.Utc).ToShortDateString() : "") + " </td>" +
                      "</tr>" +
                      "</table>" +

                      "</td>" +
                      "</tr>");
            sb.Append("</table>");


            var properties = new[]
                    {
                        "AÑO",
                        "ENERO","FEBRERO","MARZO","ABRIL","MAYO",
                        "JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE",
                        "NOVIEMBRE","DICIEMBRE", "TOTAL"
                    };

            var body = "<table style='border:1px solid black; font-size:10px;'>" +
                        "<tr>";
            for (int i = 0; i < properties.Length; i++)
            {
                body += "<td style='border-bottom: 1px solid #ddd;'>" + properties[i] + "</td>";
            }
            body += "</tr>";
            var lastYear = 0;
            decimal ene = 0, feb = 0, mar = 0, abr = 0, may = 0, jun = 0, jul = 0, ago = 0, sep = 0, oct = 0, nov = 0, dic = 0;

            foreach (var p in reportContributionPayment)
            {

                acumula(p, ref ene, ref feb, ref mar,
                    ref abr, ref may, ref jun,
                    ref jul, ref ago, ref sep,
                    ref oct, ref nov, ref dic);

                var suma = ene + feb + mar + abr + may + jun + jul + ago + sep + oct + nov + dic;

                if (suma > 0)
                {
                    body += "<tr>" +
                        "<td>" + p.Year + "</td>" +
                        "<td>" + (ene == 0 ? "-" : ene.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (feb == 0 ? "-" : feb.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (mar == 0 ? "-" : mar.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (abr == 0 ? "-" : abr.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (may == 0 ? "-" : may.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (jun == 0 ? "-" : jun.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (jul == 0 ? "-" : jul.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (ago == 0 ? "-" : ago.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (sep == 0 ? "-" : sep.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (oct == 0 ? "-" : oct.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (nov == 0 ? "-" : nov.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (dic == 0 ? "-" : dic.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "<td>" + (suma == 0 ? "-" : suma.ToString("c", new CultureInfo("es-PE"))) + "</td>" +
                        "</tr>";
                    ene = 0; feb = 0; mar = 0; abr = 0; may = 0;
                    jun = 0; jul = 0; ago = 0; sep = 0; oct = 0; nov = 0; dic = 0;
                }

            }

            body += "</table>";

            sb.Append(body);
            return sb.ToString();
        }

        private void acumula(ReportContributionPayment p,
             ref decimal ene, ref decimal feb, ref decimal mar, ref decimal abr,
             ref decimal may, ref decimal jun, ref decimal jul, ref decimal ago,
             ref decimal sep, ref decimal oct, ref decimal nov, ref decimal dic)
        {
            ene += p.Ene; feb += p.Feb; mar += p.Mar; abr += p.Abr;
            may += p.May; jun += p.Jun; jul += p.Jul; ago += p.Ago;
            sep += p.Sep; oct += p.Oct; nov += p.Nov; dic += p.Dic;
        }


        public virtual void ExportReportLoanPaymentToXlsx(Stream stream, Customer customer, Loan loan, IList<ReportLoanPayment> reportLoanPayment)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Apoyo Social Económico");
                try
                {
                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e) { }

                #region Summary

                worksheet.Cells["A6:A9"].Style.Font.Bold = true;
                worksheet.Cells["E6:E9"].Style.Font.Bold = true;
                worksheet.Cells["G6:G9"].Style.Font.Bold = true;

                worksheet.Cells["A6"].Value = "Aportante:";
                worksheet.Cells["B6:C6"].Merge = true;
                worksheet.Cells["B6"].Value = customer.GetFullName();
                worksheet.Cells["A7"].Value = "Dni:";
                worksheet.Cells["B7:C7"].Merge = true;
                worksheet.Cells["B7"].Value = customer.GetGenericAttribute(SystemCustomerAttributeNames.Dni);
                worksheet.Cells["A8"].Value = "N° Adm:";
                worksheet.Cells["B8:C8"].Merge = true;
                worksheet.Cells["B8"].Value = customer.GetGenericAttribute(SystemCustomerAttributeNames.AdmCode);
                worksheet.Cells["A9"].Value = "Solicitado:";
                worksheet.Cells["B9:C9"].Merge = true;
                worksheet.Cells["B9"].Value = _dateTimeHelper.ConvertToUserTime(loan.CreatedOnUtc, DateTimeKind.Utc).ToString(CultureInfo.InvariantCulture);

                worksheet.Cells["E6"].Value = "Plazo:";
                worksheet.Cells["F6"].Value = string.Format("{0} Meses", loan.Period);
                worksheet.Cells["E7"].Value = "Cuota Mensual:";
                worksheet.Cells["F7"].Value = loan.MonthlyQuota.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells["E8"].Value = "Importe:";
                worksheet.Cells["F8"].Value = loan.LoanAmount.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells["E9"].Value = "Total a Girar:";
                worksheet.Cells["F9"].Value = loan.TotalToPay.ToString("c", new CultureInfo("es-PE"));

                worksheet.Cells["G6"].Value = "T.E.A:";
                worksheet.Cells["H6"].Value = (loan.Tea / 100).ToString("p", new CultureInfo("es-PE"));
                worksheet.Cells["G7"].Value = "Seg Desgravamen:";
                worksheet.Cells["H7"].Value = (loan.Safe / 100).ToString("p", new CultureInfo("es-PE"));
                worksheet.Cells["G8"].Value = "Total Intereses:";
                worksheet.Cells["H8"].Value = loan.TotalFeed.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells["G9"].Value = "Total Desgravamen:";
                worksheet.Cells["H9"].Value = loan.TotalSafe.ToString("c", new CultureInfo("es-PE"));

                #endregion

                //Create Headers and format them 
                var properties = new[]
                    {
                        "CUOTA","AÑO","MES","CAPITAL","INTERES","CUOTA MENSUAL","MONTO PAGADO","ESTADO"
                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[11, i + 1].Value = properties[i];
                    worksheet.Cells[11, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[11, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[11, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[11, i + 1].Style.Font.Bold = true;
                }

                var row = 12;
                var totalMonthlyCapital = 0M;
                var totalMonthlyFee = 0M;
                var totalMonthlyQuota = 0M;
                var totalMonthlyPayed = 0M;

                foreach (var p in reportLoanPayment)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.Quota;
                    worksheet.Cells[row, col].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                    col++;
                    worksheet.Cells[row, col].Value = p.Year;
                    worksheet.Cells[row, col].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                    col++;
                    worksheet.Cells[row, col].Value = p.MonthName;
                    col++;
                    worksheet.Cells[row, col].Value = p.MonthlyCapital.ToString("c", new CultureInfo("es-PE"));
                    worksheet.Cells[row, col].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                    col++;
                    worksheet.Cells[row, col].Value = p.MonthlyFee.ToString("c", new CultureInfo("es-PE"));
                    worksheet.Cells[row, col].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                    col++;
                    worksheet.Cells[row, col].Value = p.MonthlyQuota.ToString("c", new CultureInfo("es-PE"));
                    worksheet.Cells[row, col].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                    col++;
                    worksheet.Cells[row, col].Value = p.MonthlyPayed.ToString("c", new CultureInfo("es-PE"));
                    worksheet.Cells[row, col].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                    col++;
                    worksheet.Cells[row, col].Value = GetStateLoanName(p.StateId);

                    totalMonthlyCapital += p.MonthlyCapital;
                    totalMonthlyFee += p.MonthlyFee;
                    totalMonthlyQuota += p.MonthlyQuota;
                    totalMonthlyPayed += p.MonthlyPayed;
                    row++;
                }

                worksheet.Cells[row, 1].Value = "Total";
                worksheet.Cells[row, 1].Style.Font.Bold = true;
                worksheet.Cells[row, 4].Value = totalMonthlyCapital.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells[row, 4].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells[row, 4].Style.Font.Bold = true;
                worksheet.Cells[row, 5].Value = totalMonthlyFee.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells[row, 5].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells[row, 5].Style.Font.Bold = true;
                worksheet.Cells[row, 6].Value = totalMonthlyQuota.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells[row, 6].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells[row, 6].Style.Font.Bold = true;
                worksheet.Cells[row, 7].Value = totalMonthlyPayed.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells[row, 7].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells[row, 7].Style.Font.Bold = true;

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportReportLoanPaymentKardexToXlsx(Stream stream, Customer customer, Loan loan, IList<ReportLoanPaymentKardex> reportLoanPaymentKardex)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Apoyo Social Económico Kardex");

                try
                {
                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e) { }

                #region Summary

                worksheet.Cells["A6:A9"].Style.Font.Bold = true;
                worksheet.Cells["D6:D9"].Style.Font.Bold = true;
                worksheet.Cells["G6:G9"].Style.Font.Bold = true;

                worksheet.Cells["A6"].Value = "Nombre:";
                worksheet.Cells["B6"].Value = customer.GetFullName();
                worksheet.Cells["A7"].Value = "Dni:";
                worksheet.Cells["B7"].Value = customer.GetGenericAttribute(SystemCustomerAttributeNames.Dni);
                worksheet.Cells["A8"].Value = "N° Adm:";
                worksheet.Cells["B8"].Value = customer.GetGenericAttribute(SystemCustomerAttributeNames.AdmCode);
                worksheet.Cells["A9"].Value = "Fecha de Solicitud:";
                worksheet.Cells["B9"].Value = _dateTimeHelper.ConvertToUserTime(loan.CreatedOnUtc, DateTimeKind.Utc).ToString(CultureInfo.InvariantCulture);

                worksheet.Cells["D6"].Value = "Plazo:";
                worksheet.Cells["E6"].Value = string.Format("{0} Meses", loan.Period);
                worksheet.Cells["D7"].Value = "Cuota Mensual:";
                worksheet.Cells["E7"].Value = loan.MonthlyQuota.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells["D8"].Value = "Importe:";
                worksheet.Cells["E8"].Value = loan.LoanAmount.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells["D9"].Value = "Total a Girar:";
                worksheet.Cells["E9"].Value = loan.TotalToPay.ToString("c", new CultureInfo("es-PE"));

                worksheet.Cells["G6"].Value = "T.E.A:";
                worksheet.Cells["H6"].Value = (loan.Tea / 100).ToString("p", new CultureInfo("es-PE"));
                worksheet.Cells["G7"].Value = "Seg Desgravamen:";
                worksheet.Cells["H7"].Value = (loan.Safe / 100).ToString("p", new CultureInfo("es-PE"));
                worksheet.Cells["G8"].Value = "Total Intereses:";
                worksheet.Cells["H8"].Value = loan.TotalFeed.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells["G9"].Value = "Total Desgravamen:";
                worksheet.Cells["H9"].Value = loan.TotalSafe.ToString("c", new CultureInfo("es-PE"));

                #endregion

                //Create Headers and format them 
                var properties = new[]
                    {
                        "ESTADO","TIPO","AÑO","MES","MONTO PAGADO",
                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[11, i + 1].Value = properties[i];
                    worksheet.Cells[11, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[11, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[11, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[11, i + 1].Style.Font.Bold = true;
                }

                var row = 12;

                foreach (var p in reportLoanPaymentKardex)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = GetStateLoanName(p.StateId);
                    col++;
                    worksheet.Cells[row, col].Value = p.IsAutomatic == 1 ? "Automático" : "Manual";
                    col++;
                    worksheet.Cells[row, col].Value = p.Year;
                    col++;
                    worksheet.Cells[row, col].Value = p.MonthName;
                    col++;
                    worksheet.Cells[row, col].Value = p.MonthlyPayed.ToString("c", new CultureInfo("es-PE"));

                    row++;
                }

                worksheet.Cells[row, 1].Value = "Total Amortizado";
                worksheet.Cells[row, 1].Style.Font.Bold = true;
                worksheet.Cells[row, 5].Value = loan.TotalPayed.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells[row, 5].Style.Font.Bold = true;

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportReportContributionBenefitToXlsx(Stream stream, Customer customer, ContributionBenefit contributionBenefit,
            IList<ReportContributionBenefit> reportContributionBenefit)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            var report = reportContributionBenefit.FirstOrDefault();

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add(report.BenefitName);
                try
                {
                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e) { }

                #region 1. DATOS GENERALES :

                worksheet.Cells["C5"].Value = report.BenefitType.ToUpper();
                worksheet.Cells["C5"].Style.Font.Bold = true;
                worksheet.Cells["C6"].Value = report.BenefitName.ToUpper();
                worksheet.Cells["C6"].Style.Font.Bold = true;
                worksheet.Cells["C7"].Value = "Nº DE LIQUIDACION: " + report.NumberOfLiquidation;
                worksheet.Cells["C7"].Style.Font.Bold = true;
                worksheet.Cells["A7:D7"].Style.Border.Bottom.Style = ExcelBorderStyle.Thick;

                worksheet.Cells["A9"].Value = "1. DATOS GENERALES :";
                worksheet.Cells["A9"].Style.Font.Bold = true;
                worksheet.Cells["A9"].Style.Font.UnderLine = true;

                worksheet.Cells["B10"].Value = "1.1";
                worksheet.Cells["B10"].Style.Font.Bold = true;
                worksheet.Cells["C10"].Value = "N° Adm:";
                worksheet.Cells["C10"].Style.Font.Bold = true;
                worksheet.Cells["D10"].Value = customer.GetGenericAttribute(SystemCustomerAttributeNames.AdmCode);

                worksheet.Cells["B11"].Value = "1.2";
                worksheet.Cells["B11"].Style.Font.Bold = true;
                worksheet.Cells["C11"].Value = "Dni:";
                worksheet.Cells["C11"].Style.Font.Bold = true;
                worksheet.Cells["D11"].Value = customer.GetGenericAttribute(SystemCustomerAttributeNames.Dni);

                worksheet.Cells["B12"].Value = "1.3";
                worksheet.Cells["B12"].Style.Font.Bold = true;
                worksheet.Cells["C12"].Value = "Apellidos y Nombres:";
                worksheet.Cells["C12"].Style.Font.Bold = true;
                worksheet.Cells["D12"].Value = customer.GetFullName();


                worksheet.Cells["B13"].Value = "1.4";
                worksheet.Cells["B13"].Style.Font.Bold = true;
                worksheet.Cells["C13"].Value = "Fecha Ingreso:";
                worksheet.Cells["C13"].Style.Font.Bold = true;
                worksheet.Cells["D13"].Value = _dateTimeHelper.ConvertToUserTime(customer.CreatedOnUtc, DateTimeKind.Utc).ToString(CultureInfo.InvariantCulture);

                worksheet.Cells["B14"].Value = "1.5";
                worksheet.Cells["B14"].Style.Font.Bold = true;
                worksheet.Cells["C14"].Value = "Años Aportados:";
                worksheet.Cells["C14"].Style.Font.Bold = true;
                worksheet.Cells["D14"].Value = report.YearInActivity + " años";

                var offset = 15;

                if (!string.IsNullOrEmpty(contributionBenefit.CustomValue1))
                {
                    worksheet.Cells["B" + offset].Value = "1." + (offset - 9);
                    worksheet.Cells["B" + offset].Style.Font.Bold = true;
                    worksheet.Cells["C" + offset].Value = contributionBenefit.CustomField1;
                    worksheet.Cells["C" + offset].Style.Font.Bold = true;
                    worksheet.Cells["D" + offset].Value = contributionBenefit.CustomValue1;
                    offset++;
                }

                if (!string.IsNullOrEmpty(contributionBenefit.CustomValue2))
                {
                    worksheet.Cells["B" + offset].Value = "1." + (offset - 9);
                    worksheet.Cells["B" + offset].Style.Font.Bold = true;
                    worksheet.Cells["C" + offset].Value = contributionBenefit.CustomField2;
                    worksheet.Cells["C" + offset].Style.Font.Bold = true;
                    worksheet.Cells["D" + offset].Value = contributionBenefit.CustomValue2;
                    offset++;
                }

                offset++;
                offset++;

                #endregion

                #region 2. CALCULO AUXILIO ECONOMICO :

                worksheet.Cells["A" + offset].Value = "2. CALCULO AUXILIO ECONOMICO";
                worksheet.Cells["A" + offset].Style.Font.Bold = true;
                worksheet.Cells["A" + offset].Style.Font.UnderLine = true;
                offset++;

                worksheet.Cells["B" + offset].Value = "2.1";
                worksheet.Cells["B" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Value = "En Base al Beneficio Economico según Calculo Matematico Actuarial:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.AmountBaseOfBenefit.ToString("c");
                offset++;

                worksheet.Cells["B" + offset].Value = "2.2";
                worksheet.Cells["B" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Value = "Factor Variable Según Años Aportados:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.TabValue;
                offset++;

                worksheet.Cells["B" + offset].Value = "2.3";
                worksheet.Cells["B" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Value = "Porcentaje a Pagar:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.Discount.ToString("P");
                offset++;

                #region 2.4 Sumatoria Aportes y Apoyo del Fondo de Reserva

                worksheet.Cells["B" + offset].Value = "2.4";
                worksheet.Cells["B" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Value = "Sumatoria Aportes y Apoyo del Fondo de Reserva:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                offset++;

                worksheet.Cells["C" + offset].Value = "2.4.1 Aportes del Asociado en Actividad:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.TotalContributionCopere.ToString("c");
                offset++;

                worksheet.Cells["C" + offset].Value = "2.4.2. Aportes del Asociado en Retiro:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.TotalContributionCaja.ToString("c");
                offset++;

                worksheet.Cells["C" + offset].Value = "2.4.3. Aportes Pagos Personales:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.TotalContributionPersonalPayment.ToString("c");
                offset++;

                worksheet.Cells["C" + offset].Value = "2.4.4. Apoyo Fondo de Reserva:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.ReserveFund.ToString("c");
                offset++;

                worksheet.Cells["C" + offset].Value = "2.4.5. Aportacion Total:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["C" + offset].Style.Fill.BackgroundColor.SetColor(ColorTranslator.FromHtml("#77dd77"));
                worksheet.Cells["D" + offset].Value = report.SubTotalToPay.ToString("c");
                worksheet.Cells["D" + offset].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["D" + offset].Style.Fill.BackgroundColor.SetColor(ColorTranslator.FromHtml("#77dd77"));
                offset++;

                #endregion

                #region 2.4 Deducciones

                worksheet.Cells["B" + offset].Value = "2.5";
                worksheet.Cells["B" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Value = "Deducciones";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                offset++;

                worksheet.Cells["C" + offset].Value = "2.5.1. Prestamos Pendites:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.TotalLoan;
                offset++;

                worksheet.Cells["C" + offset].Value = "2.5.2. Aportes Pendientes:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = report.TotalLoanToPay.ToString("c");
                offset++;

                worksheet.Cells["C" + offset].Value = "2.5.3. Deducción Total:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["C" + offset].Style.Fill.BackgroundColor.SetColor(ColorTranslator.FromHtml("#77dd77"));
                worksheet.Cells["D" + offset].Value = report.TotalLoanToPay.ToString("c");
                worksheet.Cells["D" + offset].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["D" + offset].Style.Fill.BackgroundColor.SetColor(ColorTranslator.FromHtml("#77dd77"));
                offset++;

                #endregion

                #region 2.6 Beneficio Económico a Liquidar:

                worksheet.Cells["B" + offset].Value = "2.6";
                worksheet.Cells["B" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Value = "Beneficio Económico a Liquidar:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["D" + offset].Value = (report.TotalToPay).ToString("C", new CultureInfo("es-PE"));
                offset++;

                #endregion

                #region 2.7 Pago Beneficiarios según Sucesion Intestada Nº 1863

                worksheet.Cells["B" + offset].Value = "2.7";
                worksheet.Cells["B" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Value = "Pago Beneficiarios según Sucesion Intestada Nº 1863";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                offset++;

                if (report.Checks != null)
                {
                    var checks = report.Checks.Split('|');
                    var index = 1;
                    foreach (var check in checks)
                    {
                        worksheet.Cells["C" + offset].Value = "2.7." + index + check.Split('-')[0];
                        worksheet.Cells["C" + offset].Style.Font.Bold = true;
                        worksheet.Cells["D" + offset].Value = Convert.ToDecimal(check.Split('-')[1]).ToString("c");
                        offset++;
                        index++;
                    }
                }
                #endregion

                worksheet.Cells["B" + offset].Value = "2.8";
                worksheet.Cells["B" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Value = "Auxilio Economico total a pagar:";
                worksheet.Cells["C" + offset].Style.Font.Bold = true;
                worksheet.Cells["C" + offset].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["C" + offset].Style.Fill.BackgroundColor.SetColor(ColorTranslator.FromHtml("#77dd77"));
                worksheet.Cells["D" + offset].Value = report.TotalToPay.ToString("c", new CultureInfo("es-PE"));
                worksheet.Cells["D" + offset].Style.Fill.PatternType = ExcelFillStyle.Solid;
                worksheet.Cells["D" + offset].Style.Fill.BackgroundColor.SetColor(ColorTranslator.FromHtml("#77dd77"));
                offset++;
                offset++;
                offset++;
                offset++;
                offset++;

                #endregion

                #region Firmas

                worksheet.Cells["A" + offset].Style.Border.Bottom.Style = ExcelBorderStyle.DashDot;
                worksheet.Cells["A" + (offset + 1)].Value = _signatureSettings.BenefitRightName;
                worksheet.Cells["A" + (offset + 1)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["A" + (offset + 2)].Value = _signatureSettings.BenefitRightPosition;
                worksheet.Cells["A" + (offset + 2)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["A" + (offset + 3)].Value = _signatureSettings.DefaultName;
                worksheet.Cells["A" + (offset + 3)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;

                worksheet.Cells["C" + offset].Style.Border.Bottom.Style = ExcelBorderStyle.DashDot;
                worksheet.Cells["C" + (offset + 1)].Value = _signatureSettings.BenefitCenterName;
                worksheet.Cells["C" + (offset + 1)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["C" + (offset + 2)].Value = _signatureSettings.BenefitCenterName;
                worksheet.Cells["C" + (offset + 2)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["C" + (offset + 3)].Value = _signatureSettings.DefaultName;
                worksheet.Cells["C" + (offset + 3)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;

                worksheet.Cells["E" + (offset)].Style.Border.Bottom.Style = ExcelBorderStyle.DashDot;
                worksheet.Cells["E" + (offset + 1)].Value = _signatureSettings.BenefitLeftName;
                worksheet.Cells["E" + (offset + 1)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["E" + (offset + 2)].Value = _signatureSettings.BenefitLeftPosition;
                worksheet.Cells["E" + (offset + 3)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["E" + (offset + 3)].Value = _signatureSettings.DefaultName;
                worksheet.Cells["E" + (offset + 3)].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                #endregion

                var imagePathSignature = new Bitmap(new MemoryStream(Convert.FromBase64String(ESCUDO)));
                var imageSignature = new Bitmap(imagePathSignature);
                var excelImageSignature = worksheet.Drawings.AddPicture("Firma", imageSignature);
                excelImageSignature.From.Column = 2;
                excelImageSignature.From.Row = offset + 4;
                excelImageSignature.SetSize(115, 115);
                excelImageSignature.AdjustPositionAndSize();

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }

        }

        public virtual void ExportGlobalReportToXlsx(MemoryStream stream, int year, int month, IList<ReportGlobal> globalReport)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Resumen");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e) { }


                #region Summary

                var date = new DateTime(year, month, 1);

                worksheet.Cells["C5:C7"].Style.Font.Bold = true;
                worksheet.Cells["C5:C7"].Style.Font.Size = 20;
                worksheet.Cells["C5:C7"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["C5"].Value = "APORTACIONES / APOYO SOCIAL ECONOMICO";
                worksheet.Cells["C6"].Value = "COPERE / CAJA / OTROS";
                worksheet.Cells["C7"].Value = "MES: " + date.ToString("MMMM", new CultureInfo("es-PE")).ToUpper() + " AÑO: " + year;

                #endregion

                //Create Headers and format them 
                var properties = new[]
                    {
                        "TIPO","N° ADMINISTRATIVO","APELLIDOS Y NOMBRE","FECHA PROGRAMADA","FECHA EJECUTADA","NUMERO","VALOR DE COUTA","PROCESO","ENTIDAD","ESTADO"
                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[9, i + 1].Value = properties[i];
                    worksheet.Cells[9, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[9, i + 1].Style.Font.Bold = true;
                }

                var row = 10;
                var total = 0M;
                foreach (var p in globalReport)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.Source;
                    col++;
                    worksheet.Cells[row, col].Value = p.AdmCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.LastName + " ,  " + p.FirstName;
                    col++;
                    worksheet.Cells[row, col].Value = p.ScheduledDate;
                    col++;
                    worksheet.Cells[row, col].Value = p.ProcessedDate;
                    col++;
                    worksheet.Cells[row, col].Value = p.Number;
                    col++;
                    worksheet.Cells[row, col].Value = p.Payed.ToString("c", new CultureInfo("es-PE"));
                    col++;
                    worksheet.Cells[row, col].Value = p.IsAutomatic == 1 ? "Automático" : "Manual";
                    col++;
                    worksheet.Cells[row, col].Value = p.BankName;
                    col++;
                    worksheet.Cells[row, col].Value = p.Source == "Aportaciones" ? GetStateContributionName(p.StateId) : GetStateLoanName(p.StateId);

                    total += p.Payed;
                    row++;
                }

                worksheet.Cells[row, 6].Value = "Total";
                worksheet.Cells[row, 6].Style.Font.Bold = true;
                worksheet.Cells[row, 7].Value = total.ToString("c", new CultureInfo("es-PE"));

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportDetailLoanToXlsx(MemoryStream stream, DateTime from, DateTime to, string source, IList<ReportLoanDetail> reportLoan)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Apoyo Social Económico");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e) { }


                #region Summary
                worksheet.Cells["E5:K5"].Merge = true;
                worksheet.Cells["E6:K6"].Merge = true;
                worksheet.Cells["E7:K7"].Merge = true;
                worksheet.Cells["E8:K8"].Merge = true;
                worksheet.Cells["E5:K8"].Style.Font.Bold = true;
                worksheet.Cells["E5:K8"].Style.Font.Size = 20;
                worksheet.Cells["E5:K8"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["E5"].Value = "APOYO SOCIAL ECONOMICO";
                worksheet.Cells["E6"].Value = "REPORTE";
                worksheet.Cells["E7"].Value = source.ToUpper();
                worksheet.Cells["E8"].Value = "DESDE :" + from.ToShortDateString() + " - HASTA:" + to.ToShortDateString();

                #endregion

                //Create Headers and format them 
                var properties = new[]
                    {
                        "APELLIDOS Y NOMBRE","N° ADMINISTRATIVO","SITUACION MILITAR","FECHA DE GIRO","ORDEN DE PAGO",
                        "MONTO SOLICITADO","MMONTO ENTREGADO","CUOTAS","MONTO PAGADO","MONTO ADEUDADO",
                        "ADEUDA"
                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[9, i + 1].Value = properties[i];
                    worksheet.Cells[9, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[9, i + 1].Style.Font.Bold = true;
                }

                var row = 10;

                foreach (var p in reportLoan)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.LastName + " ,  " + p.FirstName;
                    col++;
                    worksheet.Cells[row, col].Value = p.AdmCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.MilitarySituation;
                    col++;
                    worksheet.Cells[row, col].Value = p.ApprovalOn;
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanNumber;
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanAmount.ToString("c", new CultureInfo("es-PE"));
                    col++;
                    worksheet.Cells[row, col].Value = p.TotalToPay.ToString("c", new CultureInfo("es-PE"));
                    col++;
                    worksheet.Cells[row, col].Value = p.Period;
                    col++;
                    worksheet.Cells[row, col].Value = p.MonthlyPayed.ToString("c", new CultureInfo("es-PE"));
                    col++;
                    worksheet.Cells[row, col].Value = p.TotalAmount.ToString("c", new CultureInfo("es-PE"));
                    col++;
                    row++;
                }


                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportSummaryContributionToXlsx(MemoryStream stream, int fromId, int toId, int typeId, IList<ReportSummaryContribution> summaryContribution)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Aportacines");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e)
                {
                }

                #region Summary
                worksheet.Cells["A5:O5"].Merge = true;
                worksheet.Cells["A6:O6"].Merge = true;
                worksheet.Cells["A5:O6"].Style.Font.Bold = true;
                worksheet.Cells["A5:O6"].Style.Font.Size = 20;
                worksheet.Cells["A5:O6"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["A5"].Value = "CONSOLIDADO DE APORTACIONES";
                worksheet.Cells["A6"].Value = "ENERO " + fromId + " DICIEMBRE " + toId;

                #endregion

                //Create Headers and format them 
                var properties = new[]
                    {
                        "N° ADMINISTRATIVO","APELLIDO Y NOMBRE","FUENTE",
                        "ENERO","FEBRERO","MARZO","ABRIL","MAYO",
                        "JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE",
                        "NOVIEMBE","DICIEMBRE","TOTAL"
                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[9, i + 1].Value = properties[i];
                    worksheet.Cells[9, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[9, i + 1].Style.Font.Bold = true;
                }

                var row = 10;
                var totalEne = 0M;
                var totalFeb = 0M;
                var totalMar = 0M;
                var totalAbr = 0M;
                var totalMay = 0M;
                var totalJun = 0M;
                var totalJul = 0M;
                var totalAgo = 0M;
                var totalSep = 0M;
                var totalOct = 0M;
                var totalNov = 0M;
                var totalDic = 0M;
                var totalLine = 0M;

                foreach (var p in summaryContribution)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.CustomerAdmCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.CustomerLastName + " ," + p.CustomerName;
                    col++;
                    worksheet.Cells[row, col].Value = p.TypeSource;
                    col++;
                    worksheet.Cells[row, col].Value = p.Ene;
                    totalEne += p.Ene;
                    col++;
                    worksheet.Cells[row, col].Value = p.Feb;
                    totalFeb += p.Feb;
                    col++;
                    worksheet.Cells[row, col].Value = p.Mar;
                    totalMar += p.Mar;
                    col++;
                    worksheet.Cells[row, col].Value = p.Abr;
                    totalAbr += p.Abr;
                    col++;
                    worksheet.Cells[row, col].Value = p.May;
                    totalMay += p.May;
                    col++;
                    worksheet.Cells[row, col].Value = p.Jun;
                    totalJun += p.Jun;
                    col++;
                    worksheet.Cells[row, col].Value = p.Jul;
                    totalJul += p.Jul;
                    col++;
                    worksheet.Cells[row, col].Value = p.Ago;
                    totalAgo += p.Ago;
                    col++;
                    worksheet.Cells[row, col].Value = p.Sep;
                    totalSep += p.Sep;
                    col++;
                    worksheet.Cells[row, col].Value = p.Oct;
                    totalOct += p.Oct;
                    col++;
                    worksheet.Cells[row, col].Value = p.Nov;
                    totalNov += p.Nov;
                    col++;
                    worksheet.Cells[row, col].Value = p.Dic;
                    totalDic += p.Dic;
                    col++;
                    worksheet.Cells[row, col].Value = p.Ene + p.Feb + p.Mar + p.Abr + p.May + p.Jul + p.Jun + p.Ago + p.Sep + p.Oct + p.Nov + p.Dic;
                    totalLine += p.Ene + p.Feb + p.Mar + p.Abr + p.May + p.Jul + p.Jun + p.Ago + p.Sep + p.Oct + p.Nov + p.Dic;
                    col++;
                    row++;
                }

                worksheet.Cells[row, 4].Value = totalEne;
                worksheet.Cells[row, 5].Value = totalFeb;
                worksheet.Cells[row, 6].Value = totalMar;
                worksheet.Cells[row, 7].Value = totalAbr;
                worksheet.Cells[row, 8].Value = totalMay;
                worksheet.Cells[row, 9].Value = totalJun;
                worksheet.Cells[row, 10].Value = totalJul;
                worksheet.Cells[row, 11].Value = totalAgo;
                worksheet.Cells[row, 12].Value = totalSep;
                worksheet.Cells[row, 13].Value = totalOct;
                worksheet.Cells[row, 14].Value = totalNov;
                worksheet.Cells[row, 15].Value = totalDic;
                worksheet.Cells[row, 16].Value = totalLine;


                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportSummaryContributionToXlsx(MemoryStream stream, DateTime from, DateTime to, int typeId, IList<ReportSummaryContribution> summaryContribution)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Aportacines");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e)
                {
                }

                #region Summary
                worksheet.Cells["A5:O5"].Merge = true;
                worksheet.Cells["A6:O6"].Merge = true;
                worksheet.Cells["A5:O6"].Style.Font.Bold = true;
                worksheet.Cells["A5:O6"].Style.Font.Size = 20;
                worksheet.Cells["A5:O6"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["A5"].Value = "CONSOLIDADO DE APORTACIONES";
                worksheet.Cells["A6"].Value = "DESDE " + from.ToShortDateString() + " HASTA " + to.ToShortDateString();

                #endregion

                //Create Headers and format them 
                var properties = new[]
                    {
                        "N° ADMINISTRATIVO","APELLIDO Y NOMBRE","FUENTE",
                        "ENERO","FEBRERO","MARZO","ABRIL","MAYO",
                        "JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE",
                        "NOVIEMBE","DICIEMBRE","TOTAL"
                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[9, i + 1].Value = properties[i];
                    worksheet.Cells[9, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[9, i + 1].Style.Font.Bold = true;
                }

                var row = 10;
                var totalEne = 0M;
                var totalFeb = 0M;
                var totalMar = 0M;
                var totalAbr = 0M;
                var totalMay = 0M;
                var totalJun = 0M;
                var totalJul = 0M;
                var totalAgo = 0M;
                var totalSep = 0M;
                var totalOct = 0M;
                var totalNov = 0M;
                var totalDic = 0M;
                var totalLine = 0M;

                foreach (var p in summaryContribution)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.CustomerAdmCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.CustomerLastName + " ," + p.CustomerName;
                    col++;
                    worksheet.Cells[row, col].Value = p.TypeSource;
                    col++;
                    worksheet.Cells[row, col].Value = p.Ene;
                    totalEne += p.Ene;
                    col++;
                    worksheet.Cells[row, col].Value = p.Feb;
                    totalFeb += p.Feb;
                    col++;
                    worksheet.Cells[row, col].Value = p.Mar;
                    totalMar += p.Mar;
                    col++;
                    worksheet.Cells[row, col].Value = p.Abr;
                    totalAbr += p.Abr;
                    col++;
                    worksheet.Cells[row, col].Value = p.May;
                    totalMay += p.May;
                    col++;
                    worksheet.Cells[row, col].Value = p.Jun;
                    totalJun += p.Jun;
                    col++;
                    worksheet.Cells[row, col].Value = p.Jul;
                    totalJul += p.Jul;
                    col++;
                    worksheet.Cells[row, col].Value = p.Ago;
                    totalAgo += p.Ago;
                    col++;
                    worksheet.Cells[row, col].Value = p.Sep;
                    totalSep += p.Sep;
                    col++;
                    worksheet.Cells[row, col].Value = p.Oct;
                    totalOct += p.Oct;
                    col++;
                    worksheet.Cells[row, col].Value = p.Nov;
                    totalNov += p.Nov;
                    col++;
                    worksheet.Cells[row, col].Value = p.Dic;
                    totalDic += p.Dic;
                    col++;
                    worksheet.Cells[row, col].Value = p.Ene + p.Feb + p.Mar + p.Abr + p.May + p.Jul + p.Jun + p.Ago + p.Sep + p.Oct + p.Nov + p.Dic;
                    totalLine += p.Ene + p.Feb + p.Mar + p.Abr + p.May + p.Jul + p.Jun + p.Ago + p.Sep + p.Oct + p.Nov + p.Dic;
                    col++;
                    row++;
                }

                worksheet.Cells[row, 4].Value = totalEne;
                worksheet.Cells[row, 5].Value = totalFeb;
                worksheet.Cells[row, 6].Value = totalMar;
                worksheet.Cells[row, 7].Value = totalAbr;
                worksheet.Cells[row, 8].Value = totalMay;
                worksheet.Cells[row, 9].Value = totalJun;
                worksheet.Cells[row, 10].Value = totalJul;
                worksheet.Cells[row, 11].Value = totalAgo;
                worksheet.Cells[row, 12].Value = totalSep;
                worksheet.Cells[row, 13].Value = totalOct;
                worksheet.Cells[row, 14].Value = totalNov;
                worksheet.Cells[row, 15].Value = totalDic;
                worksheet.Cells[row, 16].Value = totalLine;


                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }
        public virtual void ExportMilitarSituationToXlsx(MemoryStream stream, string militarySituation, IList<ReportMilitarSituation> militarSituations)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Situacion Militar");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e)
                {
                }

                #region Summary
                worksheet.Cells["A5:M5"].Merge = true;
                worksheet.Cells["A6:M6"].Merge = true;
                worksheet.Cells["A5:M6"].Style.Font.Bold = true;
                worksheet.Cells["A5:M6"].Style.Font.Size = 20;
                worksheet.Cells["A5:M6"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["A5"].Value = "SITUACION MILITAR DE LOS APORTANTES";
                worksheet.Cells["A6"].Value = militarySituation.ToUpper();

                #endregion

                var properties = new[]
                    {
                        "N° AAMINISTRATIVO","APELLIDOS Y NOMBRE","SITUACION MILITAR",
                        "APORTACION","AUTORIZACION DESCUENTO","MONTO POR APORTAR","MONTO ABONADO (A LA FECHA)","MONTO APORTACION PENDIENTE",
                        "Estado Apoyo","N° ORDEN DE PRESTAMO","MONTO SOLICITADO", "MONTO DEL APOYO", "MONTO Apoyo Pendiente",
                        "MONTO PAGADO (A LA FECHA)","PERIODO"

                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[9, i + 1].Value = properties[i];
                    worksheet.Cells[9, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[9, i + 1].Style.Font.Bold = true;
                }

                var row = 10;

                foreach (var p in militarSituations)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.AdmCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.LastName + " ," + p.FirstName;
                    col++;
                    worksheet.Cells[row, col].Value = militarySituation;
                    col++;
                    worksheet.Cells[row, col].Value = p.ContributionState ? "Activo" : "Inactivo";
                    col++;
                    worksheet.Cells[row, col].Value = p.ContributionAuthorizeDiscont;
                    col++;
                    worksheet.Cells[row, col].Value = p.ContributionAmountMeta;
                    col++;
                    worksheet.Cells[row, col].Value = p.ContributionAmountPayed;
                    col++;
                    worksheet.Cells[row, col].Value = p.ContributionAmountMeta - p.ContributionAmountPayed;
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanState ? "Activo" : "Inactivo";
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanNumber;
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanAmount;
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanTotalAmount;
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanTotalAmount - p.LoanTotalPayed;
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanTotalPayed;
                    col++;
                    worksheet.Cells[row, col].Value = p.LoanPeriod;
                    col++;
                    row++;

                }

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportBenefitToXlsx(MemoryStream stream, Benefit getBenefitById, IList<ReportBenefit> benefit)
        {
            throw new NotImplementedException();
        }

        public virtual string ExportScheduleTxt(ScheduleBatch schedule)
        {
            var nameFile = "";
            if (schedule.SystemName.Trim().ToUpper() == ("KS.BATCH.CAJA.OUT"))
                nameFile = string.Format("6008_{0}00.txt", schedule.PeriodYear.ToString("0000") + schedule.PeriodMonth.ToString("00"));
            else
                nameFile = string.Format("8001_{0}00.txt", schedule.PeriodYear.ToString("0000") + schedule.PeriodMonth.ToString("00"));


            var fileReaded = File.ReadAllLines(Path.Combine(Path.Combine(schedule.PathBase, schedule.FolderMoveToDone),
                        nameFile));

            var sb = new StringBuilder();

            foreach (var s in fileReaded)
            {
                sb.AppendLine(s);
            }

            return sb.ToString();

        }

        public virtual void ExportBankPaymentToXlsx(MemoryStream stream, DateTime from, DateTime to, IList<ReportBankPayment> summaryBankPayment)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Depositos Bancarios");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e)
                {
                }

                #region Summary

                worksheet.Cells["A5:M5"].Merge = true;
                worksheet.Cells["A6:M6"].Merge = true;
                worksheet.Cells["A5:M6"].Style.Font.Bold = true;
                worksheet.Cells["A5:M6"].Style.Font.Size = 20;
                worksheet.Cells["A5:M6"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["A5"].Value = "DEPOSITOS BANCARIOS ";
                worksheet.Cells["A6"].Value = "Desde: " + from.ToShortDateString() + " - Hasta: " + to.ToShortDateString();

                #endregion


                var properties = new[]
                {
                    "APELLIDOS Y NOMBRE", "N° ADMINISTRATIVO", "DNI", "SITUACION MILITAR","FUENTE","BANCO" ,"N° TRANSACCION", "FECHA", "MONTO"
                };

                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[9, i + 1].Value = properties[i];
                    worksheet.Cells[9, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[9, i + 1].Style.Font.Bold = true;
                }

                var row = 10;
                var total = 0M;

                foreach (var p in summaryBankPayment)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.LastName + "," + p.FirstName;
                    col++;
                    worksheet.Cells[row, col].Value = p.AdmCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.Dni;
                    col++;
                    worksheet.Cells[row, col].Value = p.MilitarySituation;
                    col++;
                    worksheet.Cells[row, col].Value = p.Data;
                    col++;
                    worksheet.Cells[row, col].Value = p.BankName;
                    col++;
                    worksheet.Cells[row, col].Value = p.TransactionNumber;
                    col++;
                    worksheet.Cells[row, col].Value = p.ProcessedDateOnUtc;
                    col++;
                    worksheet.Cells[row, col].Value = p.AmountPayed;
                    total += p.AmountPayed;
                    col++;

                    row++;

                }
                worksheet.Cells[row, 8].Value = "Total";
                worksheet.Cells[row, 8].Style.Font.Bold = true;
                worksheet.Cells[row, 9].Value = total.ToString("c", new CultureInfo("es-PE"));

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportinterfaceToXlsx(MemoryStream stream, int yearId, int monthId,
            IList<ReportInterfaceLoan> interfaceLoan, IList<ReportInterfaceContribution> interfaceContribution)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            #region Loan

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Apoyo Social Economico");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e)
                {
                }

                #region Summary

                worksheet.Cells["A5:M5"].Merge = true;
                worksheet.Cells["A6:M6"].Merge = true;
                worksheet.Cells["A5:M6"].Style.Font.Bold = true;
                worksheet.Cells["A5:M6"].Style.Font.Size = 20;
                worksheet.Cells["A5:M6"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["A5"].Value = "APOYO SOCIAL ECONÓMICO";
                worksheet.Cells["A6"].Value = "Año: " + yearId + " - Mes: " + monthId.ToString("00");

                #endregion


                var properties = new[]
                {
                    "APELLIDOS Y NOMBRE", "N° ADMINISTRATIVO", "DNI", "SITUACION MILITAR", "ESTADO ASOCIADO","N° AUTORIZACION","SOLICITADO","COUTA", "FECHA PROGRAMADA", "CAPITAL", "INTERES",
                    "MONTO COUTA", "MONTO PAGADO", "ESTADO"
                };

                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[9, i + 1].Value = properties[i];
                    worksheet.Cells[9, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[9, i + 1].Style.Font.Bold = true;

                    var row = 10;

                    foreach (var p in interfaceLoan)
                    {
                        var col = 1;
                        worksheet.Cells[row, col].Value = p.LastName + "," + p.FirstName;
                        col++;
                        worksheet.Cells[row, col].Value = p.AdmCode;
                        col++;
                        worksheet.Cells[row, col].Value = p.Dni;
                        col++;
                        worksheet.Cells[row, col].Value = p.MilitarySituation;
                        col++;
                        worksheet.Cells[row, col].Value = p.Active;
                        col++;
                        worksheet.Cells[row, col].Value = p.LoanNumber;
                        col++;
                        worksheet.Cells[row, col].Value = p.LoanAmount;
                        col++;
                        worksheet.Cells[row, col].Value = p.Quota;
                        col++;
                        worksheet.Cells[row, col].Value = p.ScheduledDateOnUtc.ToShortDateString();
                        col++;
                        worksheet.Cells[row, col].Value = p.MonthlyCapital;
                        col++;
                        worksheet.Cells[row, col].Value = p.MonthlyFee;
                        col++;
                        worksheet.Cells[row, col].Value = p.MonthlyQuota;
                        col++;
                        worksheet.Cells[row, col].Value = p.MonthlyPayed;
                        col++;
                        worksheet.Cells[row, col].Value = p.State;
                        col++;
                        row++;
                    }
                }

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }

                #endregion

                #region Contribution

                // get handle to the existing worksheet
                worksheet = xlPackage.Workbook.Worksheets.Add("Aportaciones");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e)
                {
                }

                #region Summary

                worksheet.Cells["A5:M5"].Merge = true;
                worksheet.Cells["A6:M6"].Merge = true;
                worksheet.Cells["A5:M6"].Style.Font.Bold = true;
                worksheet.Cells["A5:M6"].Style.Font.Size = 20;
                worksheet.Cells["A5:M6"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["A5"].Value = "APORTACIONES";
                worksheet.Cells["A6"].Value = worksheet.Cells["A6"].Value = "Año: " + yearId + " - Mes: " + monthId.ToString("00");

                #endregion


                var properties2 = new[]
                {
                    "APELLIDOS Y NOMBRE", "N° ADMINISTRATIVO", "DNI", "SITUACION MILITAR", "ESTADO ASOCIADO", "NUMERO", "FECHA PROGRAMADA","MONTO1", "MONTO22", "MONTO ANTERIOR",
                    "MONTO TOTAL", "MONTO PAFADO", "ESTADO"
                };

                for (var i = 0; i < properties2.Length; i++)
                {
                    worksheet.Cells[9, i + 1].Value = properties2[i];
                    worksheet.Cells[9, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[9, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[9, i + 1].Style.Font.Bold = true;

                    var row = 10;

                    foreach (var p in interfaceContribution)
                    {
                        var col = 1;
                        worksheet.Cells[row, col].Value = p.LastName + "," + p.FirstName;
                        col++;
                        worksheet.Cells[row, col].Value = p.AdmCode;
                        col++;
                        worksheet.Cells[row, col].Value = p.Dni;
                        col++;
                        worksheet.Cells[row, col].Value = p.MilitarySituation;
                        col++;
                        worksheet.Cells[row, col].Value = p.Active;
                        col++;
                        worksheet.Cells[row, col].Value = p.Number;
                        col++;
                        worksheet.Cells[row, col].Value = p.ScheduledDateOnUtc.ToShortDateString();
                        col++;
                        worksheet.Cells[row, col].Value = p.Amount1;
                        col++;
                        worksheet.Cells[row, col].Value = p.Amount2;
                        col++;
                        worksheet.Cells[row, col].Value = p.AmountOld;
                        col++;
                        worksheet.Cells[row, col].Value = p.AmountTotal;
                        col++;
                        worksheet.Cells[row, col].Value = p.AmountPayed;
                        col++;
                        worksheet.Cells[row, col].Value = p.State;
                        col++;
                        row++;
                    }
                }

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }

            #endregion
        }

        public virtual void ExportReportInfoToXlsx(MemoryStream stream, string source, List<Info> info)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add(source.Replace(".", " ").Replace("Ks", "").Replace("Batch", "").Trim());

                var properties = new[]
                    {
                        "AÑO","MES","AsociadoId","APELLIDOS Y NOMBRE","N° ADMINISTRATIVO","DNI","TOTAL APORTACION","TOTAL PAGADO","TOTAL APOYO",
                        "COUTA APORTACION","MONTO 1", "MONTO 2", "MONTO 3","MONTO ANTERIOR","MONTO TOTAL","MONTO APORTADO","ESTADOAPORTACIONID",
                        "ES AUTOMATICO","BANCO","CUENTA","TRANSACCION","REFERENCIA", "DESCRIPCION",
                        "COUTA APOYO","COUTA MENSUAL","INTERES","CAPITAL","MONTO PAGADO","ESTADOAPOYOID","ES AUTOMATICO","BANCO",
                        "CUENTA","TRANSACCION","REFERENCIA", "DESCRIPCION"

                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[1, i + 1].Value = properties[i];
                    worksheet.Cells[1, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[1, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[1, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[1, i + 1].Style.Font.Bold = true;
                }

                var row = 2;

                foreach (var p in info)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.Year;
                    col++;
                    worksheet.Cells[row, col].Value = p.Month;
                    col++;
                    worksheet.Cells[row, col].Value = p.CustomerId;
                    col++;
                    worksheet.Cells[row, col].Value = p.CompleteName;
                    col++;
                    worksheet.Cells[row, col].Value = p.AdminCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.Dni;
                    col++;
                    worksheet.Cells[row, col].Value = p.TotalContribution;
                    col++;
                    worksheet.Cells[row, col].Value = p.TotalPayed;
                    col++;
                    worksheet.Cells[row, col].Value = p.TotalLoan;
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Number.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Amount1.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Amount2.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Amount3.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.AmountOld.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.AmountTotal.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.AmountPayed.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.StateId.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.IsAutomatic.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.BankName.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.AccountNumber.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.TransactionNumber.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Reference.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Description.ToString() : "";
                    col++;

                    foreach (var infoLoan in p.InfoLoans)
                    {
                        worksheet.Cells[row, col].Value = infoLoan.Quota;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.MonthlyQuota;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.MonthlyFee;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.MonthlyCapital;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.MonthlyPayed;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.StateId;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.IsAutomatic;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.BankName;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.AccountNumber;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.TransactionNumber;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.Reference;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.Description;
                        col++;
                        row++;
                        col = col - 12;
                    }
                    row++;
                }

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public void ExportReportInfoMergeToXlsx(MemoryStream stream, string source, List<Info> send, List<Info> recive)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add(source.Replace(".", " ").Replace("Ks", "").Replace("Batch", "").Replace(","," ").Trim());

                var properties = new[]
                    {
                        "AÑO","MES","AsociadoId","APELLIDOS Y NOMBRE","N° ADMINISTRATIVO","DNI","TOTAL APORTACION","TOTAL PAGADO","TOTAL APOYO",
                        "COUTA APORTACION","MONTO 1", "MONTO 2", "MONTO 3","MONTO ANTERIOR","MONTO TOTAL","MONTO APORTADO","ESTADOAPORTACIONID",
                        "ES AUTOMATICO","BANCO","CUENTA","TRANSACCION","REFERENCIA", "DESCRIPCION",
                        "ASEID","ASEDETALLEID",
                        "COUTA APOYO","COUTA MENSUAL","INTERES","CAPITAL","MONTO PAGADO","ESTADOAPOYOID","ES AUTOMATICO","BANCO",
                        "CUENTA","TRANSACCION","REFERENCIA", "DESCRIPCION"

                    };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[1, i + 1].Value = properties[i];
                    worksheet.Cells[1, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[1, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[1, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[1, i + 1].Style.Font.Bold = true;
                }

                var row = 2;

                foreach (var p in send)
                {
                    var col = 1;
                    var totalPayed=recive.Where(X => X.AdminCode == p.AdminCode).Sum(X => X.TotalPayed);
                    var color = totalPayed ==0 ? 
                                               Color.FromArgb(255, 100, 100) : 
                                               (p.TotalContribution + p.TotalLoan) == totalPayed ?
                                                                                                  Color.FromArgb(51, 255, 51) : 
                                                                                                  Color.FromArgb(255, 255, 0);
                    worksheet.Cells[row, col].Value = p.Year;
                    col++;
                    worksheet.Cells[row, col].Value = p.Month.ToString("D2");
                    col++;
                    worksheet.Cells[row, col].Value = p.CustomerId;
                    col++;
                    worksheet.Cells[row, col].Value = p.CompleteName;
                    col++;
                    worksheet.Cells[row, col].Value = p.AdminCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.Dni;
                    col++;
                    worksheet.Cells[row, col].Value = p.TotalContribution;
                    col++;
                    worksheet.Cells[row, col].Value = totalPayed;
                    worksheet.Cells[row, col].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[row, col].Style.Fill.BackgroundColor.SetColor(color);
                    worksheet.Cells[row, col].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[row, col].Style.Font.Bold = true;

                    col++;
                    worksheet.Cells[row, col].Value = p.TotalLoan;
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Number.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Amount1.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Amount2.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Amount3.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.AmountOld.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.AmountTotal.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.AmountPayed.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.StateId.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.IsAutomatic.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.BankName.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.AccountNumber.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.TransactionNumber.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Reference.ToString() : "";
                    col++;
                    worksheet.Cells[row, col].Value = p.InfoContribution != null ? p.InfoContribution.Description.ToString() : "";
                    col++;

                    foreach (var infoLoan in p.InfoLoans)
                    {
                        worksheet.Cells[row, col].Value = infoLoan.LoanId;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.LoanPaymentId;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.Quota;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.MonthlyQuota;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.MonthlyFee;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.MonthlyCapital;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.MonthlyPayed;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.StateId;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.IsAutomatic;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.BankName;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.AccountNumber;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.TransactionNumber;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.Reference;
                        col++;
                        worksheet.Cells[row, col].Value = infoLoan.Description;
                        col++;
                        row++;
                        col = col - 12;
                    } 
                }

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportChecksToXlsx(MemoryStream stream, DateTime from, DateTime to, IList<ReportChecks> checks)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Cheques");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e)
                {
                }


                #region Summary

                worksheet.Cells["B5:I5"].Merge = true;
                worksheet.Cells["B6:I6"].Merge = true;
                worksheet.Cells["B5:I6"].Style.Font.Bold = true;
                worksheet.Cells["B5:I6"].Style.Font.Size = 20;
                worksheet.Cells["B5:I6"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["B5"].Value = "APOYO SOCIAL ECONOMICO";
                worksheet.Cells["B6"].Value = "DESDE :" + from.ToShortDateString() + " - HASTA:" +
                                              to.ToShortDateString();

                #endregion

                //Create Headers and format them 
                var properties = new[]
                {
                    "APELLIDOS Y NOMBRE", "N° ADMINISTRATIVO", "DNI", "SITUACION MILITAR", "FUENTE",
                    "MONTO DEL CHEQUE", "N° CUENTA", "BANCO", "N° CHEQUE","ESTADO","FECHA"
                };
                for (var i = 0; i < properties.Length; i++)
                {
                    worksheet.Cells[7, i + 1].Value = properties[i];
                    worksheet.Cells[7, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[7, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[7, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[7, i + 1].Style.Font.Bold = true;
                }

                var row = 8;

                foreach (var p in checks)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.LastName + " ,  " + p.FirstName;
                    col++;
                    worksheet.Cells[row, col].Value = p.AdmCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.Dni;
                    col++;
                    worksheet.Cells[row, col].Value = p.MilitarySituation;
                    col++;
                    worksheet.Cells[row, col].Value = p.Source;
                    col++;
                    worksheet.Cells[row, col].Value = p.Amount.ToString("c", new CultureInfo("es-PE"));
                    col++;
                    worksheet.Cells[row, col].Value = p.AccountNumber;
                    col++;
                    worksheet.Cells[row, col].Value = p.BankName;
                    col++;
                    worksheet.Cells[row, col].Value = p.CheckNumber;
                    col++;
                    worksheet.Cells[row, col].Value = p.State;
                    col++;
                    worksheet.Cells[row, col].Value = p.Date;
                    col++;
                    row++;
                }

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        public virtual void ExportReportCustomerToXlsx(MemoryStream stream, IList<ReportCustomer> customer)
        {
            if (stream == null)
                throw new ArgumentNullException("stream");

            using (var xlPackage = new ExcelPackage(stream))
            {
                // get handle to the existing worksheet
                var worksheet = xlPackage.Workbook.Worksheets.Add("Asociados");
                // var imagePath = _webHelper.MapPath(@"C:\inetpub\wwwroot\Acmr\Administration\Content\images\logo.png");
                try
                {

                    var image = new Bitmap(new MemoryStream(Convert.FromBase64String(IMAGE)));
                    var excelImage = worksheet.Drawings.AddPicture("ACMR", image);
                    excelImage.From.Column = 0;
                    excelImage.From.Row = 0;
                }
                catch (Exception e)
                {
                }

                #region Summary

                worksheet.Cells["B5:I5"].Merge = true;
                worksheet.Cells["B6:I6"].Merge = true;
                worksheet.Cells["B5:I6"].Style.Font.Bold = true;
                worksheet.Cells["B5:I6"].Style.Font.Size = 20;
                worksheet.Cells["B5:I6"].Style.HorizontalAlignment = ExcelHorizontalAlignment.CenterContinuous;
                worksheet.Cells["B5"].Value = "ASOCIADOS";
                worksheet.Cells["B6"].Value = "";

                #endregion

                var customHeader = _customerAttributeService.GetAllCustomerAttributes().Select(x => x.Name).ToList().ToArray();
                var map = new Dictionary<string, int>();

                //Create Headers and format them 
                var properties = new List<string>
                {
                    "ID","GENERO","APELLIDOS Y NOMBRE", "N° ADMINISTRATIVO", "DNI",
                    "SITUACION MILITAR ID","SITUACION MILITAR",
                    "N° CARTA DECLARATORIA","FECHA DE INGRESO","FECHA NACIMIENTO",
                    "PAIS","PROVINCIA","DEPARTAMENTO","DIRECCION1","DIRECCION2","TELEFONO","EMAIL",
                     "ESTADO ASOCIADO","ROLES"
                };
                var t = 1;
                foreach (var s in customHeader)
                {
                    map.Add(s, properties.Count + t);
                    t++;
                }
                //"MONTO","MONTO PAGADO","CICLOS TOTALES","CICLOS PAGADOS","CICLOS PARCIALES","CICLOS RETRASOS","DESCRIPCION" 

                properties.AddRange(customHeader);

                for (var i = 0; i < properties.Count; i++)
                {
                    worksheet.Cells[7, i + 1].Value = properties[i];
                    worksheet.Cells[7, i + 1].Style.Fill.PatternType = ExcelFillStyle.Solid;
                    worksheet.Cells[7, i + 1].Style.Fill.BackgroundColor.SetColor(Color.FromArgb(128, 235, 142));
                    worksheet.Cells[7, i + 1].Style.Fill.BackgroundColor.Tint = 0.599993896298105M;
                    worksheet.Cells[7, i + 1].Style.Font.Bold = true;
                }

                var row = 8;

                foreach (var p in customer)
                {
                    var col = 1;
                    worksheet.Cells[row, col].Value = p.CustomerId;
                    col++;
                    worksheet.Cells[row, col].Value = p.Gender;
                    col++;
                    worksheet.Cells[row, col].Value = p.FirstName + " " + p.LastName;
                    col++;
                    worksheet.Cells[row, col].Value = p.AdmCode;
                    col++;
                    worksheet.Cells[row, col].Value = p.Dni;
                    col++;
                    worksheet.Cells[row, col].Value = p.MilitarySituationId;
                    col++;
                    worksheet.Cells[row, col].Value = p.MilitarySituationName;
                    col++;
                    worksheet.Cells[row, col].Value = p.DeclaratoryLetter;
                    col++;
                    worksheet.Cells[row, col].Value = p.DateOfAdmission.ToString("dd-MM-yyyy");
                    col++;
                    worksheet.Cells[row, col].Value = p.DateOfBirth.ToString("dd-MM-yyyy");
                    col++;
                    worksheet.Cells[row, col].Value = p.CountryName;
                    col++;
                    worksheet.Cells[row, col].Value = p.StateProvinceName;
                    col++;
                    worksheet.Cells[row, col].Value = p.CityName;
                    col++;
                    worksheet.Cells[row, col].Value = p.StreetAddress;
                    col++;
                    worksheet.Cells[row, col].Value = p.StreetAddress2;
                    col++;
                    worksheet.Cells[row, col].Value = p.Phone;
                    col++;
                    worksheet.Cells[row, col].Value = p.Email;
                    col++;
                    worksheet.Cells[row, col].Value = p.Active;
                    col++;
                    worksheet.Cells[row, col].Value = p.CustomerRoleNames;
                    col++;
                    //worksheet.Cells[row, col].Value = p.Contribution != null ? p.Contribution.AmountMeta.ToString() : "";
                    //col++;
                    //worksheet.Cells[row, col].Value = p.Contribution != null ? p.Contribution.AmountPayed.ToString() : "";
                    //col++;
                    //worksheet.Cells[row, col].Value = p.Contribution != null ? p.Contribution.TotalOfCycles.ToString() : "";
                    //col++;
                    //worksheet.Cells[row, col].Value = p.Contribution != null ? p.Contribution.PayedCycles.ToString() : "";
                    //col++;
                    //worksheet.Cells[row, col].Value = p.Contribution != null ? p.Contribution.PartialCycles.ToString() : "";
                    //col++;
                    //worksheet.Cells[row, col].Value = p.Contribution != null ? p.Contribution.DelayCycles.ToString() : "";
                    //col++;
                    //worksheet.Cells[row, col].Value = p.Contribution != null ? p.Contribution.Description.ToString() : "";
                    //col++;
                    string value = "";
                    foreach (var ca in p.CustomerAttributes)
                    {
                        if (ca.CustomerAttributeValues != null)
                        {
                            value = string.Join(",", ca.CustomerAttributeValues.Where(x => x.IsPreSelected).Select(x => x.Name).ToList());
                            worksheet.Cells[row, map[ca.Name]].Value = value;
                        }
                        //else
                        //    worksheet.Cells[row, map[ca.Name]].Value = value;

                    }
                    row++;
                }

                for (var i = 1; i <= worksheet.Dimension.Columns; i++)
                {
                    worksheet.Column(i).AutoFit();
                }
                xlPackage.Save();
            }
        }

        #endregion

        #region Utilities

        private string GetMilitarySituation(string id)
        {
            try
            {
                var _id = Convert.ToInt32(id);
                switch (_id)
                {
                    case (int)CustomerMilitarySituation.Actividad:
                        return "Actividad - COPERE (8001)";
                    case (int)CustomerMilitarySituation.Retiro:
                        return "Retiro - CPMP (6008)";
                    case (int)CustomerMilitarySituation.Personal:
                        return "Personal";
                    case (int)CustomerMilitarySituation.InfoCorp:
                        return "InfoCorp";
                    case (int)CustomerMilitarySituation.Gozado:
                        return "Goce de Beneficio";
                    case (int)CustomerMilitarySituation.Interno:
                        return "Personal Interno";
                    case (int)CustomerMilitarySituation.Renuncia:
                        return "Renuncia";
                }
            }
            catch (Exception e)
            {
                return "";
            }

            return "";
        }

        private Color GetColor(int isAutomatic, int stateId)
        {
            //ContributionState.Pendiente => Color.Gainsboro
            //ContributionState.EnProceso => Color.LightBlue
            //ContributionState.PagoParcial => Color.PaleGreen
            //ContributionState.Pagado.ToString() + " Automático"  => Color.LightPink
            //ContributionState.EnProceso.ToString()+ " Manual"  => Color.PaleGoldenrod

            //#D5D5D5(1)=Pendiente
            //#FFFFd8(2)=En_Proceso
            //#FFDAB4(3)=Pago_Parcial
            //#BDD7EE(4)=Pagado_Automatico
            //#DAFFB4(5)=Pago_Personal
            //#FFB4B4(6)=Sin_Liquidez

            if ((stateId == (int)ContributionState.Pendiente))
                return ColorTranslator.FromHtml("#D5D5D5");
            if (stateId == (int)ContributionState.SinLiquidez)
                return ColorTranslator.FromHtml("#FFB4B4");
            if ((stateId == (int)ContributionState.EnProceso))
                return ColorTranslator.FromHtml("#FFFFd8");
            if ((stateId == (int)ContributionState.PagoParcial))
                return ColorTranslator.FromHtml("#FFDAB4");
            if ((stateId == (int)ContributionState.Pagado) && isAutomatic == 1)
                return ColorTranslator.FromHtml("#BDD7EE");
            if ((stateId == (int)ContributionState.Pagado) && isAutomatic == 0)
                return ColorTranslator.FromHtml("#DAFFB4");

            return ColorTranslator.FromHtml("#D5D5D5");
        }

        private string GetStateContributionName(int stateId)
        {
            switch (stateId)
            {
                case (int)ContributionState.EnProceso: return "En Proceso";
                case (int)ContributionState.Pendiente: return "Pendiente";
                case (int)ContributionState.PagoParcial: return "Pago Parcial";
                case (int)ContributionState.Pagado: return "Pagado";
                case (int)ContributionState.SinLiquidez: return "Sin Liquidez";
                case (int)ContributionState.Devolucion: return "Devolucion";
                case (int)ContributionState.PagoPersonal: return "Pago Personal";
            }
            return "";
        }
        private string GetStateLoanName(int stateId)
        {
            switch (stateId)
            {
                case (int)LoanState.EnProceso: return "En Proceso";
                case (int)LoanState.Pendiente: return "Pendiente";
                case (int)LoanState.PagoParcial: return "Pago Parcial";
                case (int)LoanState.Pagado: return "Pagado";
                case (int)LoanState.SinLiquidez: return "Sin Liquidez";
                case (int)LoanState.Devolucion: return "Devolucion";
                case (int)LoanState.Anulado: return "Anulado";
                case (int)LoanState.PagoPersonal: return "Pago Personal";
                case (int)LoanState.Cancelado: return "Cancelado";
            }
            return "";
        }

        #endregion
    }
}